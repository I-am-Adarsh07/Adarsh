<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details</title>
    <link rel="stylesheet" href="styles.css"> 
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* General Layout & Header Styles (Copied from index.html for consistency) */
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .main-header { background-color: #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .header-content { 
            display: flex; justify-content: space-between; align-items: center; padding: 15px 0; 
        }
        .logo a { font-size: 1.8em; font-weight: 700; color: #ff9900; text-decoration: none; }
        .search-bar { display: flex; flex-grow: 1; max-width: 500px; margin: 0 30px; }
        .search-bar input { padding: 10px; border: 2px solid #ff9900; border-right: none; border-radius: 6px 0 0 6px; width: 100%; font-size: 1em; }
        .search-bar button { padding: 10px 15px; background-color: #ff9900; border: none; border-radius: 0 6px 6px 0; color: white; cursor: pointer; }
        
        .header-nav { display: flex; align-items: center; gap: 20px; }
        /* FIX: Header link styles to show text next to icon */
        .header-nav a { 
            text-decoration: none; 
            color: #333; 
            font-weight: 500; 
            display: flex; 
            align-items: center; 
            gap: 5px; 
            transition: color 0.2s;
        }
        .header-nav a:hover { color: #ff9900; }
        .cart-icon { color: #333; font-weight: 600; }

        /* Product Detail Styles (Your existing styles) */
        .product-detail-container { display: flex; flex-wrap: wrap; gap: 40px; margin-top: 40px; }
        .product-gallery { flex: 1 1 40%; display: flex; gap: 10px; }
        .thumbnail-list { display: flex; flex-direction: column; gap: 10px; }
        .thumbnail { width: 80px; height: 80px; overflow: hidden; border: 1px solid #ccc; cursor: pointer; transition: border-color 0.2s; }
        .thumbnail img { width: 100%; height: 100%; object-fit: cover; }
        .thumbnail.active { border-color: #ff9900; border-width: 3px; }
        .main-image-display { flex-grow: 1; max-width: 500px; }
        .main-image-display img { width: 100%; height: auto; object-fit: contain; border: 1px solid #e0e0e0; padding: 10px; }
        .product-info { flex: 1 1 50%; }
        .product-info h1 { font-size: 2.2em; margin-bottom: 10px; }
        .product-info .price-block { margin: 20px 0; border-top: 1px solid #eee; padding-top: 15px; }
        .product-info .current-price { font-size: 2.5em; color: #28a745; font-weight: 700; }
        .product-info .old-price { text-decoration: line-through; color: #999; font-size: 1.2em; margin-left: 20px; }
        .product-info .rating-block { color: #ffc107; font-size: 1.2em; margin-bottom: 20px; }
        .action-buttons { display: flex; gap: 20px; margin-top: 30px; }
        .buy-now-btn, .add-to-cart-btn {
            padding: 15px 30px; font-size: 1.2em; font-weight: 700; border: none; border-radius: 8px; 
            cursor: pointer; flex: 1; transition: background-color 0.2s; color: white;
        }
        .buy-now-btn { background-color: #28a745; }
        .buy-now-btn:hover { background-color: #218838; }
        .add-to-cart-btn { background-color: #ff9900; }
        .add-to-cart-btn:hover { background-color: #cc7a00; }
        
        /* Footer and Toast styles */
        .main-footer { text-align: center; padding: 20px; background-color: #333; color: white; margin-top: 40px; }
        #customToast {
            visibility: hidden; position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); 
            z-index: 1000; min-width: 250px; background-color: #333; color: #fff; text-align: center;
            border-radius: 8px; padding: 16px; font-size: 17px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: opacity 0.5s, visibility 0.5s; opacity: 0;
        }
        #customToast.show { visibility: visible; opacity: 1; }
    </style>
</head>
<body>

    <header class="main-header">
        <div class="header-content container">
            <div class="logo">
                <a href="index.html">All In One Store</a>
            </div>
            <div class="search-bar">
                <input type="text" placeholder="Search...">
                <button>üîç</button>
            </div>
            <nav class="header-nav">
                <a href="account.html">üë® **Account**</a> 
                <a href="#">‚ù§Ô∏è **Wishlist**</a>
                <a href="cart.html" class="cart-icon">üõí **Cart** (0)</a> 
            </nav>
        </div>
    </header>

    <main class="container">
        <div id="product-detail-area" class="product-detail-container">
            <p>Loading product details...</p>
        </div>
    </main>

    <footer class="main-footer">
        <p>&copy; 2025 All In One Store. All rights reserved.</p>
    </footer>
    
    <div id="customToast"></div> 
    
    <script>
        // --- 1. PRODUCT DATABASE (FIXED & COMPLETE) ---
        const productDatabase = {
            '1': { 
                title: 'Smartwatch Model X', price: 9999, oldPrice: '‚Çπ 19,999', 
                category: 'Electronics', discount: '-50% OFF', rating: 4.3,
                images: [
                    'https://www.titan.co.in/dw/image/v2/BKDD_PRD/on/demandware.static/-/Sites-titan-master-catalog/default/dwf5666e88/images/Fastrack/Catalog/38148QM01_1.jpg?sw=360&sh=360',
                    'https://www.titan.co.in/dw/image/v2/BKDD_PRD/on/demandware.static/-/Sites-titan-master-catalog/default/dw20a2e582/images/Fastrack/Catalog/38148QM01_2.jpg?sw=360&sh=360',
                    'https://www.titan.co.in/dw/image/v2/BKDD_PRD/on/demandware.static/-/Sites-titan-master-catalog/default/dw7694939b/images/Fastrack/Catalog/38148QM01_3.jpg?sw=360&sh=360',
                    'https://www.titan.co.in/dw/image/v2/BKDD_PRD/on/demandware.static/-/Sites-titan-master-catalog/default/dw10d0f50b/images/Fastrack/Catalog/38148QM01_4.jpg?sw=360&sh=360'
                ],
                description: "Experience the next level of smart technology with the Smartwatch Model X. Featuring a sleek design, long-lasting battery, and comprehensive health tracking capabilities. Perfect for fitness enthusiasts and professionals alike."
            },
            '2': { 
                title: "Man's T-shirt", price: 399, oldPrice: '‚Çπ 1,299', 
                category: 'Fashion', discount: '-70% OFF', rating: 4.8,
                images: new Array(4).fill('https://img.freepik.com/premium-photo/black-plain-shortsleeve-cotton-t-shirt-template-isolated-white-background_41929-3076.jpg'), 
                description: "A comfortable and stylish black cotton T-shirt, perfect for everyday wear. Made with 100% breathable fabric." 
            },
            '3': { 
                title: 'Premium Headphones', price: 1499, oldPrice: '‚Çπ 2,499', 
                category: 'Electronics', discount: '-40% OFF', rating: 4.1,
                images: new Array(4).fill('https://www.leafstudios.in/cdn/shop/files/1_a43c5e0b-3a47-497d-acec-b4764259b10e_1024x1024.png?v=1750486829'),
                description: "Immerse yourself in high-quality audio with these premium noise-canceling headphones."
            },
            '4': { 
                title: 'PowerBank', price: 1250, oldPrice: '‚Çπ 1,800', 
                category: 'Electronics', discount: '-30% OFF', rating: 4.7,
                images: new Array(4).fill('https://zebronics.com/cdn/shop/files/Zeb-MB10000S9-Pro-pic1.jpg?v=1755673820&width=800'),
                description: "High capacity power bank to keep your devices charged all day long."
            },
            '5': { 
                title: 'HP Victus Laptop', price: 49999, oldPrice: '‚Çπ 62,500', 
                category: 'Electronics', discount: '-20% OFF', rating: 4.6,
                images: new Array(4).fill('https://media-ik.croma.com/prod/https://media.tatacroma.com/Croma%20Assets/Computers%20Peripherals/Laptop/Images/309065_0_xb9gpu.png?tr=w-640'),
                description: "Powerful gaming laptop with latest processor and high-resolution display."
            },
            '6': { 
                title: 'Python Programming', price: 800, oldPrice: '‚Çπ 1100', 
                category: 'Books', discount: '-20% OFF', rating: 4.6,
                images: new Array(4).fill('https://in.bpbonline.com/cdn/shop/files/2289_Epub.jpg?v=1755671457&width=500'),
                description: "The definitive guide to learning Python programming, from beginner to advanced concepts."
            },
            '7': { 
                title: 'DSLR Camera', price: 34999, oldPrice: '‚Çπ 41,175', 
                category: 'Electronics', discount: '-15% OFF', rating: 4.2,
                images: new Array(4).fill('https://m.media-amazon.com/images/I/71iKNJ6rVIL._SX522_.jpg'),
                description: "Capture professional-quality photos and videos with this high-end DSLR camera."
            },
            '8': { 
                title: 'Speaker', price: 1799, oldPrice: '‚Çπ 2,500', 
                category: 'Electronics', discount: 'New', rating: 4.5,
                images: new Array(4).fill('https://media-ik.croma.com/prod/https://media.tatacroma.com/Croma%20Assets/Entertainment/Speakers%20and%20Media%20Players/Images/251614_0_ghxuff.png?tr=w-640'),
                description: "Portable Bluetooth speaker with powerful sound and long battery life."
            },
            '9': { 
                title: 'Wireless Earbuds', price: 2999, oldPrice: '‚Çπ 3,999', 
                category: 'Electronics', discount: '-25% OFF', rating: 4.9,
                images: new Array(4).fill('https://media-ik.croma.com/prod/https://media.tatacroma.com/Croma%20Assets/Entertainment/Wireless%20Earbuds/Images/272743_wpivml.png?tr=w-640'),
                description: "True wireless earbuds with superior sound quality and comfortable fit."
            }
        };

        // --- 2. CORE FUNCTIONS (Toast, Cart, Buy, getStars) ---
        function showToast(message) {
            const toast = document.getElementById("customToast");
            if (!toast) return;
            toast.textContent = message;
            toast.className = "show"; 
            setTimeout(function(){ toast.className = toast.className.replace("show", ""); }, 3000);
        }

        function updateHeaderCartCount() {
            const cartItems = JSON.parse(localStorage.getItem('cart') || '[]');
            const totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0);
            const cartIcon = document.querySelector('.cart-icon');
            if(cartIcon) {
                cartIcon.innerHTML = `üõí **Cart** (${totalItems})`;
            }
        }

        // Functions for button clicks
        function addToCart(productId) { 
            let cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const existingItem = cart.find(item => item.id === productId);
            const productDetails = productDatabase[productId];

            if (existingItem) {
                existingItem.quantity += 1;
                showToast(`‚úÖ Added one more: ${productDetails.title.substring(0, 30)}...`); 
            } else {
                cart.push({ id: productId, quantity: 1 });
                showToast(`üõí ${productDetails.title.substring(0, 30)}... added to cart!`);
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            updateHeaderCartCount(); 
        }

        function buyProduct(productId) { 
            // This function clears the cart and adds only the current item, then redirects to checkout.
            let cart = [{ id: productId, quantity: 1 }];
            localStorage.setItem('cart', JSON.stringify(cart));
            updateHeaderCartCount();
            showToast("üõçÔ∏è Proceeding to checkout...");
            // Redirect to checkout page (assuming you will create checkout.html next)
            setTimeout(() => { window.location.href = 'checkout.html'; }, 500); 
        }

        function getStars(rating) {
            const roundedRating = Math.round(rating * 2) / 2;
            const fullStars = '‚òÖ'.repeat(Math.floor(roundedRating));
            const halfStar = (roundedRating % 1 !== 0) ? '¬Ω' : '';
            const emptyStars = '‚òÜ'.repeat(5 - Math.ceil(roundedRating));
            return fullStars + halfStar + emptyStars;
        }

        // --- 3. PRODUCT RENDERING LOGIC ---

        function renderProductDetail(productId) {
            const product = productDatabase[productId];
            const detailArea = document.getElementById('product-detail-area');

            if (!product) {
                detailArea.innerHTML = '<p>‚ùå Product not found. Please check the ID.</p>';
                return;
            }

            const starsHTML = getStars(product.rating || 4.0);

            // Generate HTML for the page
            detailArea.innerHTML = `
                <div class="product-gallery">
                    <div class="thumbnail-list" id="thumbnail-list">
                        </div>
                    <div class="main-image-display">
                        <img id="main-product-image" src="${product.images[0]}" alt="${product.title}">
                    </div>
                </div>

                <div class="product-info">
                    <h1>${product.title}</h1>
                    <div class="rating-block">
                        <span class="stars">${starsHTML}</span> 
                        <span class="rating-value">${product.rating ? product.rating.toFixed(1) : 'N/A'}</span>
                    </div>

                    <div class="price-block">
                        <span class="current-price">‚Çπ ${product.price.toLocaleString('en-IN')}</span>
                        <span class="old-price">${product.oldPrice}</span>
                        <span class="discount-tag">(${product.discount || 'Sale'})</span>
                    </div>

                    <p class="description">${product.description || 'No description available.'}</p>
                    
                    <div class="action-buttons">
                        <button class="buy-now-btn" onclick="buyProduct('${productId}')">‚ö° Buy Now</button>
                        <button class="add-to-cart-btn" onclick="addToCart('${productId}')">üõí Add to Cart</button>
                    </div>
                </div>
            `;

            // Render Thumbnails and attach click handlers
            const thumbnailList = document.getElementById('thumbnail-list');
            const mainImage = document.getElementById('main-product-image');

            product.images.forEach((imgUrl, index) => {
                const thumb = document.createElement('div');
                thumb.classList.add('thumbnail');
                if (index === 0) thumb.classList.add('active');

                thumb.innerHTML = `<img src="${imgUrl}" alt="Thumbnail ${index + 1}">`;
                
                thumb.addEventListener('click', () => {
                    mainImage.src = imgUrl; // Change main image
                    
                    // Remove 'active' class from all, add to clicked one
                    document.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active'));
                    thumb.classList.add('active');
                });

                thumbnailList.appendChild(thumb);
            });
        }

        // --- 4. INITIALIZATION ---

        document.addEventListener('DOMContentLoaded', function() {
            // Get product ID from URL
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('id');

            updateHeaderCartCount();
            
            if (productId) {
                renderProductDetail(productId);
            } else {
                document.getElementById('product-detail-area').innerHTML = '<p>Product ID missing from URL.</p>';
            }
        });
        
    </script>
    <script src="security.js"></script>
</body>
</html>